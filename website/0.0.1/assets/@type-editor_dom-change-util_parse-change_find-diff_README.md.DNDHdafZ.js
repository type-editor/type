import{_ as t,o as n,c as r,ak as i}from"./chunks/framework.EVMbD_FN.js";const u=JSON.parse('{"title":"parse-change/find-diff","description":"","frontmatter":{},"headers":[],"relativePath":"@type-editor/dom-change-util/parse-change/find-diff/README.md","filePath":"@type-editor/dom-change-util/parse-change/find-diff/README.md"}'),a={name:"@type-editor/dom-change-util/parse-change/find-diff/README.md"};function o(s,e,d,h,f,p){return n(),r("div",null,[...e[0]||(e[0]=[i('<p><a href="./../../../../README.html"><strong>Type Editor</strong></a></p><hr><p><a href="./../../../../">Type Editor</a> / <a href="./../../README.html">@type-editor/dom-change-util</a> / parse-change/find-diff</p><h1 id="parse-change-find-diff" tabindex="-1">parse-change/find-diff <a class="header-anchor" href="#parse-change-find-diff" aria-label="Permalink to “parse-change/find-diff”">​</a></h1><h2 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-label="Permalink to “Functions”">​</a></h2><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><p><a href="./functions/findDiff.html">findDiff</a></p></td><td><p>Finds the difference between two fragments and returns the positions of the change.</p><p>This is the core diff algorithm for detecting what changed between the old document and the parsed DOM content. It uses ProseMirror&#39;s built-in diff methods and then applies sophisticated adjustments to handle edge cases.</p><p><strong>Algorithm Steps:</strong></p><ol><li><strong>Find diff start:</strong> Use Fragment.findDiffStart to find where content diverges</li><li><strong>Find diff end:</strong> Use Fragment.findDiffEnd to find where content converges again</li><li><strong>Adjust for preferred position:</strong> When the user&#39;s cursor is known, bias the diff boundaries toward that position for more intuitive change detection</li><li><strong>Handle surrogate pairs:</strong> Unicode characters outside BMP use surrogate pairs; ensure we don&#39;t split them when adjusting boundaries</li></ol><p><strong>Preferred Position Handling:</strong></p><p>When preferredPos is between the diff boundaries, the algorithm tries to move the boundaries to include the cursor position. This ensures changes appear to happen at the cursor rather than at arbitrary matching text positions.</p><p>For example, if typing &quot;a&quot; in &quot;bat&quot; where cursor is after &quot;b&quot;, prefer detecting the change as &quot;b|at&quot; → &quot;ba|at&quot; rather than &quot;ba|t&quot; → &quot;ba|at&quot;.</p><p><strong>Surrogate Pair Handling:</strong></p><p>UTF-16 surrogate pairs (used for emoji and other non-BMP characters) must not be split. When adjusting boundaries, if we land in the middle of a surrogate pair, adjust by one position to keep the pair intact.</p><p><strong>See</strong></p><ul><li><a href="./../../types/dom-change/DocumentChange/interfaces/DocumentChange.html">DocumentChange</a> for return type structure</li><li>getPreferredDiffPosition for how preferred position is determined</li></ul><p><strong>Remarks</strong></p><p>Includes special handling for Unicode surrogate pairs (e.g., emoji)</p></td></tr></tbody></table>',6)])])}const g=t(a,[["render",o]]);export{u as __pageData,g as default};
