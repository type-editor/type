import{_ as i,o as t,c as e,ak as a}from"./chunks/framework.EVMbD_FN.js";const k=JSON.parse('{"title":"@type-editor/dom-coords-util","description":"","frontmatter":{},"headers":[],"relativePath":"@type-editor/dom-coords-util/README.md","filePath":"@type-editor/dom-coords-util/README.md"}'),o={name:"@type-editor/dom-coords-util/README.md"};function r(l,s,n,d,h,p){return t(),e("div",null,[...s[0]||(s[0]=[a(`<p><a href="./../../README.html"><strong>Type Editor</strong></a></p><hr><p><a href="./../../">Type Editor</a> / @type-editor/dom-coords-util</p><h1 id="type-editor-dom-coords-util" tabindex="-1">@type-editor/dom-coords-util <a class="header-anchor" href="#type-editor-dom-coords-util" aria-label="Permalink to “@type-editor/dom-coords-util”">​</a></h1><p>This module was part of the <code>ProseMirror view module</code>.</p><p>DOM coordinates utility functions for Type Editor projects.</p><p>This module provides utilities for working with DOM coordinates in a rich text editor context. It handles the complex task of mapping between document positions and screen coordinates, managing scroll positions, and detecting text block boundaries.</p><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to “Installation”">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @type-editor/dom-coords-util</span></span></code></pre></div><h2 id="api-reference" tabindex="-1">API Reference <a class="header-anchor" href="#api-reference" aria-label="Permalink to “API Reference”">​</a></h2><h3 id="position-coordinate-mapping" tabindex="-1">Position &amp; Coordinate Mapping <a class="header-anchor" href="#position-coordinate-mapping" aria-label="Permalink to “Position &amp; Coordinate Mapping”">​</a></h3><h4 id="coordsatpos-view-pos-side" tabindex="-1"><code>coordsAtPos(view, pos, side)</code> <a class="header-anchor" href="#coordsatpos-view-pos-side" aria-label="Permalink to “coordsAtPos(view, pos, side)”">​</a></h4><p>Given a position in the document model, get a bounding box of the character at that position, relative to the window.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { coordsAtPos } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> coordsAtPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view, pos, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Returns: { top, bottom, left, right }</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>view</code> - The editor view</li><li><code>pos</code> - The document position to get coordinates for</li><li><code>side</code> - Direction bias: negative for before, positive for after</li></ul><p><strong>Returns:</strong> A <code>Rect</code> representing the character&#39;s bounding box</p><h4 id="posatcoords-view-coords" tabindex="-1"><code>posAtCoords(view, coords)</code> <a class="header-anchor" href="#posatcoords-view-coords" aria-label="Permalink to “posAtCoords(view, coords)”">​</a></h4><p>Given x,y coordinates on the editor, get the corresponding position in the document. This function handles various browser quirks and edge cases to accurately determine the document position from screen coordinates.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { posAtCoords } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> posAtCoords</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view, { left: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, top: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Returns: { pos: number, inside: number } | null</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>view</code> - The editor view</li><li><code>coords</code> - The screen coordinates to convert (<code>{ left, top }</code>)</li></ul><p><strong>Returns:</strong> Object containing the document position and inside information, or <code>null</code> if outside editor</p><h3 id="text-block-detection" tabindex="-1">Text Block Detection <a class="header-anchor" href="#text-block-detection" aria-label="Permalink to “Text Block Detection”">​</a></h3><h4 id="endoftextblock-view-state-dir" tabindex="-1"><code>endOfTextblock(view, state, dir)</code> <a class="header-anchor" href="#endoftextblock-view-state-dir" aria-label="Permalink to “endOfTextblock(view, state, dir)”">​</a></h4><p>Determine whether the cursor is at the edge of a text block in the given direction. This function is cached for performance - repeated calls with the same state and direction will return the cached result.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { endOfTextblock } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isAtEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> endOfTextblock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view, state, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;down&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Returns: boolean</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>view</code> - The editor view</li><li><code>state</code> - The editor state containing the current selection</li><li><code>dir</code> - The direction to check: <code>&#39;up&#39;</code>, <code>&#39;down&#39;</code>, <code>&#39;left&#39;</code>, <code>&#39;right&#39;</code>, <code>&#39;forward&#39;</code>, or <code>&#39;backward&#39;</code></li></ul><p><strong>Returns:</strong> <code>true</code> if the cursor is at the edge of a text block in the given direction</p><h3 id="scroll-management" tabindex="-1">Scroll Management <a class="header-anchor" href="#scroll-management" aria-label="Permalink to “Scroll Management”">​</a></h3><h4 id="scrollrectintoview-view-rect-startdom" tabindex="-1"><code>scrollRectIntoView(view, rect, startDOM)</code> <a class="header-anchor" href="#scrollrectintoview-view-rect-startdom" aria-label="Permalink to “scrollRectIntoView(view, rect, startDOM)”">​</a></h4><p>Scroll the given rectangle into view within the editor, walking up through scrollable ancestors and adjusting scroll positions as needed.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { scrollRectIntoView } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scrollRectIntoView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view, rect, startDOM);</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>view</code> - The editor view</li><li><code>rect</code> - The rectangle to scroll into view</li><li><code>startDOM</code> - The starting DOM node (defaults to <code>view.dom</code>)</li></ul><h4 id="storescrollpos-view" tabindex="-1"><code>storeScrollPos(view)</code> <a class="header-anchor" href="#storescrollpos-view" aria-label="Permalink to “storeScrollPos(view)”">​</a></h4><p>Store the scroll position of the editor&#39;s parent nodes, along with the top position of an element near the top of the editor. This is used to maintain viewport stability when content above changes.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { storeScrollPos } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scrollPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> storeScrollPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Returns: StoredScrollPos</span></span></code></pre></div><p><strong>Returns:</strong> A <code>StoredScrollPos</code> object containing reference element info and scroll stack</p><h4 id="resetscrollpos-storedpos" tabindex="-1"><code>resetScrollPos(storedPos)</code> <a class="header-anchor" href="#resetscrollpos-storedpos" aria-label="Permalink to “resetScrollPos(storedPos)”">​</a></h4><p>Reset the scroll position of the editor&#39;s parent nodes to what it was before, when <code>storeScrollPos</code> was called. This maintains viewport stability when content above the viewport changes.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { storeScrollPos, resetScrollPos } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scrollPos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> storeScrollPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ... perform operations that might change scroll ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resetScrollPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(scrollPos);</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>storedPos</code> - Object containing scroll position data from <code>storeScrollPos</code></li></ul><h4 id="focuspreventscroll-dom" tabindex="-1"><code>focusPreventScroll(dom)</code> <a class="header-anchor" href="#focuspreventscroll-dom" aria-label="Permalink to “focusPreventScroll(dom)”">​</a></h4><p>Focus an element without scrolling. Feature-detects support for <code>.focus({preventScroll: true})</code>, and uses a fallback when not supported.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { focusPreventScroll } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/dom-coords-util&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">focusPreventScroll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element);</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>dom</code> - The HTML element to focus without scrolling</li></ul><h2 id="types" tabindex="-1">Types <a class="header-anchor" href="#types" aria-label="Permalink to “Types”">​</a></h2><h3 id="storedscrollpos" tabindex="-1"><code>StoredScrollPos</code> <a class="header-anchor" href="#storedscrollpos" aria-label="Permalink to “StoredScrollPos”">​</a></h3><p>Interface for storing scroll position data:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StoredScrollPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  refDOM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  refTop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  stack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ScrollPos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="license" tabindex="-1">License <a class="header-anchor" href="#license" aria-label="Permalink to “License”">​</a></h2><p>MIT</p><h2 id="modules" tabindex="-1">Modules <a class="header-anchor" href="#modules" aria-label="Permalink to “Modules”">​</a></h2><table><thead><tr><th>Module</th><th>Description</th></tr></thead><tbody><tr><td><p><a href="./dom-coords/coords-at-pos/README.html">dom-coords/coords-at-pos</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/end-of-textblock/README.html">dom-coords/end-of-textblock</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/focus-prevent-scroll/README.html">dom-coords/focus-prevent-scroll</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/pos-at-coords/README.html">dom-coords/pos-at-coords</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/reset-scroll-pos/README.html">dom-coords/reset-scroll-pos</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/scroll-rect-into-view/README.html">dom-coords/scroll-rect-into-view</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/store-scroll-pos/README.html">dom-coords/store-scroll-pos</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/util/in-rect/README.html">dom-coords/util/in-rect</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/util/restore-scroll-stack/README.html">dom-coords/util/restore-scroll-stack</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/util/scroll-stack/README.html">dom-coords/util/scroll-stack</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./dom-coords/util/single-rect/README.html">dom-coords/util/single-rect</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/dom-coords/Coords/README.html">types/dom-coords/Coords</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/dom-coords/Rect/README.html">types/dom-coords/Rect</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/dom-coords/ScrollPos/README.html">types/dom-coords/ScrollPos</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/dom-coords/StoredScrollPos/README.html">types/dom-coords/StoredScrollPos</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/dom-coords/TextblockDir/README.html">types/dom-coords/TextblockDir</a></p></td><td><p>‐</p></td></tr></tbody></table>`,58)])])}const g=i(o,[["render",r]]);export{k as __pageData,g as default};
