import{_ as i,o as t,c as a,ak as e}from"./chunks/framework.EVMbD_FN.js";const c=JSON.parse('{"title":"@type-editor/history","description":"","frontmatter":{},"headers":[],"relativePath":"@type-editor/history/README.md","filePath":"@type-editor/history/README.md"}'),n={name:"@type-editor/history/README.md"};function h(l,s,r,d,p,o){return t(),a("div",null,[...s[0]||(s[0]=[e(`<p><a href="./../../README.html"><strong>Type Editor</strong></a></p><hr><p><a href="./../../">Type Editor</a> / @type-editor/history</p><h1 id="type-editor-history" tabindex="-1">@type-editor/history <a class="header-anchor" href="#type-editor-history" aria-label="Permalink to “@type-editor/history”">​</a></h1><p>A refactored version of ProseMirror&#39;s <a href="https://github.com/ProseMirror/prosemirror-history" target="_blank" rel="noreferrer">prosemirror-history</a> module, providing undo/redo history functionality for rich text editors.</p><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to “Installation”">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @type-editor/history</span></span></code></pre></div><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to “Overview”">​</a></h2><p>This module implements a selective undo/redo history for ProseMirror-based editors. Unlike a simple rollback mechanism, this history is <strong>selective</strong>, meaning it can undo specific changes while keeping other, later changes intact. This is essential for collaborative editing scenarios where multiple users may be editing simultaneously.</p><h3 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to “How It Works”">​</a></h3><p>ProseMirror&#39;s history isn&#39;t simply a way to roll back to a previous state, because ProseMirror supports applying changes without adding them to the history (for example during collaboration).</p><p>Each history &#39;Branch&#39; (one for undo, one for redo) maintains an array of &#39;Items&#39; that can optionally hold a step (an actual undoable change) and always hold a position map (needed to adjust positions for changes below them).</p><p>An item that has both a step and a selection bookmark marks the start of an &#39;event&#39; — a group of changes that will be undone or redone together.</p><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to “Usage”">​</a></h2><h3 id="basic-setup" tabindex="-1">Basic Setup <a class="header-anchor" href="#basic-setup" aria-label="Permalink to “Basic Setup”">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { history, undo, redo } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { keymap } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/keymap&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { EditorState } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/state&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EditorState.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  schema,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    history</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    keymap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;Mod-z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: undo,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;Mod-Shift-z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: redo,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="configuration-options" tabindex="-1">Configuration Options <a class="header-anchor" href="#configuration-options" aria-label="Permalink to “Configuration Options”">​</a></h3><p>The <code>history()</code> plugin accepts an optional configuration object:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">history</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  depth: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Maximum number of history events (default: 100)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  newGroupDelay: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Delay in ms before starting a new group (default: 500)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>depth</code></td><td><code>number</code></td><td><code>100</code></td><td>The number of history events to keep before the oldest events are discarded</td></tr><tr><td><code>newGroupDelay</code></td><td><code>number</code></td><td><code>500</code></td><td>The delay in milliseconds between changes after which a new history group should be started. Adjacent changes within this delay are grouped together.</td></tr></tbody></table><h2 id="commands" tabindex="-1">Commands <a class="header-anchor" href="#commands" aria-label="Permalink to “Commands”">​</a></h2><h3 id="undo-commands" tabindex="-1">Undo Commands <a class="header-anchor" href="#undo-commands" aria-label="Permalink to “Undo Commands”">​</a></h3><table tabindex="0"><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>undo</code></td><td>Undoes the last change and scrolls the selection into view. Typically bound to <code>Mod-z</code>.</td></tr><tr><td><code>undoNoScroll</code></td><td>Undoes the last change without scrolling. Useful when you want to handle scrolling manually.</td></tr></tbody></table><h3 id="redo-commands" tabindex="-1">Redo Commands <a class="header-anchor" href="#redo-commands" aria-label="Permalink to “Redo Commands”">​</a></h3><table tabindex="0"><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>redo</code></td><td>Redoes the last undone change and scrolls the selection into view. Typically bound to <code>Mod-Shift-z</code> (or <code>Mod-y</code> on Windows).</td></tr><tr><td><code>redoNoScroll</code></td><td>Redoes the last undone change without scrolling.</td></tr></tbody></table><h3 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to “Example”">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { undo, redo, undoNoScroll, redoNoScroll } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { keymap } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/keymap&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> historyKeymap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> keymap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;Mod-z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: undo,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;Mod-Shift-z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: redo,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;Mod-y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: redo, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Alternative redo binding for Windows</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="helper-functions" tabindex="-1">Helper Functions <a class="header-anchor" href="#helper-functions" aria-label="Permalink to “Helper Functions”">​</a></h2><h3 id="undodepth" tabindex="-1">undoDepth <a class="header-anchor" href="#undodepth" aria-label="Permalink to “undoDepth”">​</a></h3><p>Returns the number of undoable events available in the editor&#39;s history.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { undoDepth } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canUndo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> undoDepth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`You can undo \${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">undoDepth</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} changes\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="redodepth" tabindex="-1">redoDepth <a class="header-anchor" href="#redodepth" aria-label="Permalink to “redoDepth”">​</a></h3><p>Returns the number of redoable events available in the editor&#39;s history.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { redoDepth } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canRedo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> redoDepth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`You can redo \${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redoDepth</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} changes\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="closehistory" tabindex="-1">closeHistory <a class="header-anchor" href="#closehistory" aria-label="Permalink to “closeHistory”">​</a></h3><p>Forces subsequent changes to be recorded as a separate history event, preventing them from being merged with the previous event.</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { closeHistory } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Force the next change to start a new history event</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> closeHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state.tr);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insertText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;new text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><h3 id="ishistorytransaction" tabindex="-1">isHistoryTransaction <a class="header-anchor" href="#ishistorytransaction" aria-label="Permalink to “isHistoryTransaction”">​</a></h3><p>Returns <code>true</code> if the given transaction was generated by the history plugin (i.e., an undo or redo operation).</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { isHistoryTransaction } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@type-editor/history&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// In a plugin&#39;s appendTransaction</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendTransaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(transactions, oldState, newState) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (transactions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(isHistoryTransaction)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Handle undo/redo transactions differently</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="controlling-history" tabindex="-1">Controlling History <a class="header-anchor" href="#controlling-history" aria-label="Permalink to “Controlling History”">​</a></h2><h3 id="preventing-changes-from-being-recorded" tabindex="-1">Preventing Changes from Being Recorded <a class="header-anchor" href="#preventing-changes-from-being-recorded" aria-label="Permalink to “Preventing Changes from Being Recorded”">​</a></h3><p>You can prevent a transaction from being added to the history by setting the <code>addToHistory</code> metadata to <code>false</code>:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state.tr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insertText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setMeta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;addToHistory&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tr);</span></span></code></pre></div><p>This is useful for:</p><ul><li>Collaborative changes from other users</li><li>UI state changes that shouldn&#39;t be undoable</li><li>Decorations or annotations</li></ul><h3 id="grouping-changes" tabindex="-1">Grouping Changes <a class="header-anchor" href="#grouping-changes" aria-label="Permalink to “Grouping Changes”">​</a></h3><p>Changes made within the <code>newGroupDelay</code> window (default 500ms) are automatically grouped together as a single undo event. You can force a new group to start by using <code>closeHistory</code>:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { closeHistory } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@type-editor/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// First change</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state.tr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insertText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Force next change to be a separate event</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">closeHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state.tr));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// This will be a separate undo event</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state.tr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insertText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><h2 id="api-reference" tabindex="-1">API Reference <a class="header-anchor" href="#api-reference" aria-label="Permalink to “API Reference”">​</a></h2><h3 id="exports" tabindex="-1">Exports <a class="header-anchor" href="#exports" aria-label="Permalink to “Exports”">​</a></h3><table tabindex="0"><thead><tr><th>Export</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>history</code></td><td><code>function</code></td><td>Creates the history plugin</td></tr><tr><td><code>undo</code></td><td><code>Command</code></td><td>Undo command with scroll</td></tr><tr><td><code>undoNoScroll</code></td><td><code>Command</code></td><td>Undo command without scroll</td></tr><tr><td><code>redo</code></td><td><code>Command</code></td><td>Redo command with scroll</td></tr><tr><td><code>redoNoScroll</code></td><td><code>Command</code></td><td>Redo command without scroll</td></tr><tr><td><code>undoDepth</code></td><td><code>function</code></td><td>Get number of undo events</td></tr><tr><td><code>redoDepth</code></td><td><code>function</code></td><td>Get number of redo events</td></tr><tr><td><code>closeHistory</code></td><td><code>function</code></td><td>Close current history event</td></tr><tr><td><code>isHistoryTransaction</code></td><td><code>function</code></td><td>Check if transaction is from history</td></tr><tr><td><code>HistoryState</code></td><td><code>class</code></td><td>The history state class</td></tr><tr><td><code>HistoryOptions</code></td><td><code>type</code></td><td>Configuration options interface</td></tr><tr><td><code>mustPreserveItems</code></td><td><code>function</code></td><td>Check if items should be preserved</td></tr></tbody></table><h2 id="license" tabindex="-1">License <a class="header-anchor" href="#license" aria-label="Permalink to “License”">​</a></h2><p>MIT</p><h2 id="modules" tabindex="-1">Modules <a class="header-anchor" href="#modules" aria-label="Permalink to “Modules”">​</a></h2><table><thead><tr><th>Module</th><th>Description</th></tr></thead><tbody><tr><td><p><a href="./commands/redo/README.html">commands/redo</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./commands/redo-no-scroll/README.html">commands/redo-no-scroll</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./commands/undo/README.html">commands/undo</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./commands/undo-no-scroll/README.html">commands/undo-no-scroll</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./commands/util/build-command/README.html">commands/util/build-command</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./helper/close-history/README.html">helper/close-history</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./helper/is-history-transaction/README.html">helper/is-history-transaction</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./helper/must-preserve-items/README.html">helper/must-preserve-items</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./helper/redo-depth/README.html">helper/redo-depth</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./helper/undo-depth/README.html">helper/undo-depth</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./plugin/apply-transaction/README.html">plugin/apply-transaction</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./plugin/handle-history-input-event/README.html">plugin/handle-history-input-event</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./plugin/history-plugin/README.html">plugin/history-plugin</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./plugin/history-plugin-key/README.html">plugin/history-plugin-key</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./state/Branch/README.html">state/Branch</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./state/create-rope-sequence/README.html">state/create-rope-sequence</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./state/HistoryState/README.html">state/HistoryState</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/HistoryEventState/README.html">types/HistoryEventState</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/HistoryOptions/README.html">types/HistoryOptions</a></p></td><td><p>‐</p></td></tr><tr><td><p><a href="./types/RopeSequence/README.html">types/RopeSequence</a></p></td><td><p>‐</p></td></tr></tbody></table>`,56)])])}const E=i(n,[["render",h]]);export{c as __pageData,E as default};
