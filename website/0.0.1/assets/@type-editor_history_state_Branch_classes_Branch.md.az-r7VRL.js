import{_ as t,o as a,c as s,ak as r}from"./chunks/framework.EVMbD_FN.js";const b=JSON.parse('{"title":"Class: Branch","description":"","frontmatter":{},"headers":[],"relativePath":"@type-editor/history/state/Branch/classes/Branch.md","filePath":"@type-editor/history/state/Branch/classes/Branch.md"}'),i={name:"@type-editor/history/state/Branch/classes/Branch.md"};function n(h,e,d,o,c,l){return a(),s("div",null,[...e[0]||(e[0]=[r(`<p><a href="./../../../../../README.html"><strong>Type Editor</strong></a></p><hr><p><a href="./../../../../../">Type Editor</a> / <a href="./../../../README.html">@type-editor/history</a> / <a href="./../README.html">state/Branch</a> / Branch</p><h1 id="class-branch" tabindex="-1">Class: Branch <a class="header-anchor" href="#class-branch" aria-label="Permalink to “Class: Branch”">​</a></h1><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L106" target="_blank" rel="noreferrer">state/Branch.ts:106</a></p><p>Represents a branch in the history tree (either undo or redo history).</p><p>A branch maintains a sequence of items that represent the history of changes, where each item can contain a step (an actual change) and/or a position map (for transforming positions through the change).</p><h2 id="constructors" tabindex="-1">Constructors <a class="header-anchor" href="#constructors" aria-label="Permalink to “Constructors”">​</a></h2><h3 id="constructor" tabindex="-1">Constructor <a class="header-anchor" href="#constructor" aria-label="Permalink to “Constructor”">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Branch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(items, eventCount): Branch;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L124" target="_blank" rel="noreferrer">state/Branch.ts:124</a></p><p><strong><code>Internal</code></strong></p><p>Creates a new branch.</p><h4 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to “Parameters”">​</a></h4><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>items</code></td><td><a href="./../../../types/RopeSequence/interfaces/RopeSequence.html"><code>RopeSequence</code></a>&lt;<a href="./Item.html"><code>Item</code></a>&gt;</td><td>The sequence of history items</td></tr><tr><td><code>eventCount</code></td><td><code>number</code></td><td>The number of events (groups of changes) in this branch</td></tr></tbody></table><h4 id="returns" tabindex="-1">Returns <a class="header-anchor" href="#returns" aria-label="Permalink to “Returns”">​</a></h4><p><code>Branch</code></p><h2 id="properties" tabindex="-1">Properties <a class="header-anchor" href="#properties" aria-label="Permalink to “Properties”">​</a></h2><table tabindex="0"><thead><tr><th>Property</th><th>Modifier</th><th>Type</th><th>Defined in</th></tr></thead><tbody><tr><td><a id="property-empty"></a> <code>empty</code></td><td><code>readonly</code></td><td><code>Branch</code></td><td><a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L108" target="_blank" rel="noreferrer">state/Branch.ts:108</a></td></tr></tbody></table><h2 id="accessors" tabindex="-1">Accessors <a class="header-anchor" href="#accessors" aria-label="Permalink to “Accessors”">​</a></h2><h3 id="eventcount" tabindex="-1">eventCount <a class="header-anchor" href="#eventcount" aria-label="Permalink to “eventCount”">​</a></h3><h4 id="get-signature" tabindex="-1">Get Signature <a class="header-anchor" href="#get-signature" aria-label="Permalink to “Get Signature”">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">get </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eventCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): number;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L132" target="_blank" rel="noreferrer">state/Branch.ts:132</a></p><p>Gets the number of events in this branch.</p><h5 id="returns-1" tabindex="-1">Returns <a class="header-anchor" href="#returns-1" aria-label="Permalink to “Returns”">​</a></h5><p><code>number</code></p><h2 id="methods" tabindex="-1">Methods <a class="header-anchor" href="#methods" aria-label="Permalink to “Methods”">​</a></h2><h3 id="addmaps" tabindex="-1">addMaps() <a class="header-anchor" href="#addmaps" aria-label="Permalink to “addMaps()”">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addMaps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(maps): Branch;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L269" target="_blank" rel="noreferrer">state/Branch.ts:269</a></p><p>Adds position maps to the branch without associated steps.</p><p>This is used when changes occur that don&#39;t need to be undoable but still need to be tracked for position mapping.</p><h4 id="parameters-1" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-1" aria-label="Permalink to “Parameters”">​</a></h4><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>maps</code></td><td>readonly <code>PmStepMap</code>[]</td><td>Array of step maps to add</td></tr></tbody></table><h4 id="returns-2" tabindex="-1">Returns <a class="header-anchor" href="#returns-2" aria-label="Permalink to “Returns”">​</a></h4><p><code>Branch</code></p><p>A new branch with the maps added, or this branch if it has no events</p><hr><h3 id="addtransform" tabindex="-1">addTransform() <a class="header-anchor" href="#addtransform" aria-label="Permalink to “addTransform()”">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addTransform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   transform,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   selection,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   histOptions,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   preserveItems): Branch;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L218" target="_blank" rel="noreferrer">state/Branch.ts:218</a></p><p>Creates a new branch with the given transform added to the history.</p><p>This method processes all steps in the transform, inverts them for undo, and attempts to merge consecutive items when possible to save memory.</p><h4 id="parameters-2" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-2" aria-label="Permalink to “Parameters”">​</a></h4><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>transform</code></td><td><code>TransformDocument</code></td><td>The transform containing the steps to add</td></tr><tr><td><code>selection</code></td><td><code>SelectionBookmark</code></td><td>The selection bookmark marking the start of a new event (optional)</td></tr><tr><td><code>histOptions</code></td><td><code>Required</code>&lt;<a href="./../../../types/HistoryOptions/interfaces/HistoryOptions.html"><code>HistoryOptions</code></a>&gt;</td><td>History configuration options (depth and delay)</td></tr><tr><td><code>preserveItems</code></td><td><code>boolean</code></td><td>Whether to preserve items exactly for rebasing</td></tr></tbody></table><h4 id="returns-3" tabindex="-1">Returns <a class="header-anchor" href="#returns-3" aria-label="Permalink to “Returns”">​</a></h4><p><code>Branch</code></p><p>A new branch with the transform added</p><hr><h3 id="popevent" tabindex="-1">popEvent() <a class="header-anchor" href="#popevent" aria-label="Permalink to “popEvent()”">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">popEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state, preserveItems): HistoryEventState;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L146" target="_blank" rel="noreferrer">state/Branch.ts:146</a></p><p>Pops the latest event off the branch&#39;s history and applies it to a document transform.</p><p>This method retrieves the most recent history event, applies its steps in reverse to the current state, and returns the modified state along with the remaining history.</p><h4 id="parameters-3" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-3" aria-label="Permalink to “Parameters”">​</a></h4><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>state</code></td><td><code>PmEditorState</code></td><td>The current editor state</td></tr><tr><td><code>preserveItems</code></td><td><code>boolean</code></td><td>Whether to preserve items for rebasing (needed for collaboration)</td></tr></tbody></table><h4 id="returns-4" tabindex="-1">Returns <a class="header-anchor" href="#returns-4" aria-label="Permalink to “Returns”">​</a></h4><p><a href="./../../../types/HistoryEventState/interfaces/HistoryEventState.html"><code>HistoryEventState</code></a></p><p>The history event state with remaining branch, transform, and selection, or null if no events exist</p><hr><h3 id="rebased" tabindex="-1">rebased() <a class="header-anchor" href="#rebased" aria-label="Permalink to “rebased()”">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rebased</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rebasedTransform, rebasedCount): Branch;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/1440286448396eb7a2fecaed8442b6ac57cafd0e/packages/history/src/state/Branch.ts#L288" target="_blank" rel="noreferrer">state/Branch.ts:288</a></p><p>Adjusts the branch when remote changes are rebased in collaborative editing.</p><p>When the collaboration module receives remote changes, the history needs to adjust the steps that were rebased on top of those changes and include position maps for the remote changes in its array of items.</p><h4 id="parameters-4" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-4" aria-label="Permalink to “Parameters”">​</a></h4><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>rebasedTransform</code></td><td><code>TransformDocument</code></td><td>The transform containing the rebased changes</td></tr><tr><td><code>rebasedCount</code></td><td><code>number</code></td><td>The number of steps that were rebased</td></tr></tbody></table><h4 id="returns-5" tabindex="-1">Returns <a class="header-anchor" href="#returns-5" aria-label="Permalink to “Returns”">​</a></h4><p><code>Branch</code></p><p>A new branch with the rebased adjustments applied</p>`,71)])])}const m=t(i,[["render",n]]);export{b as __pageData,m as default};
