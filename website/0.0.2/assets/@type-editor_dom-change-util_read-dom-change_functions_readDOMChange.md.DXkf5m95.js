import{_ as t,o as i,c as a,ak as n}from"./chunks/framework.BhGvdB6H.js";const g=JSON.parse('{"title":"Function: readDOMChange()","description":"","frontmatter":{},"headers":[],"relativePath":"@type-editor/dom-change-util/read-dom-change/functions/readDOMChange.md","filePath":"@type-editor/dom-change-util/read-dom-change/functions/readDOMChange.md"}'),s={name:"@type-editor/dom-change-util/read-dom-change/functions/readDOMChange.md"};function r(d,e,o,l,h,c){return i(),a("div",null,[...e[0]||(e[0]=[n(`<p><a href="./../../../../README.html"><strong>Type Editor</strong></a></p><hr><p><a href="./../../../../">Type Editor</a> / <a href="./../../README.html">@type-editor/dom-change-util</a> / <a href="./../README.html">read-dom-change</a> / readDOMChange</p><h1 id="function-readdomchange" tabindex="-1">Function: readDOMChange() <a class="header-anchor" href="#function-readdomchange" aria-label="Permalink to “Function: readDOMChange()”">​</a></h1><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readDOMChange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">typeOver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">addedNodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Defined in: <a href="https://github.com/type-editor/type/blob/c311ca079abd6b61221c2aab5ce7aaefbf4271cf/packages/dom-change-util/src/dom-change/read-dom-change.ts#L101" target="_blank" rel="noreferrer">read-dom-change.ts:101</a></p><p>Reads and processes changes from the DOM, converting them into ProseMirror transactions.</p><p>This is the main entry point for handling DOM mutations and converting them into document updates. It orchestrates the entire DOM change detection and processing pipeline, including:</p><p><strong>Core Process:</strong></p><ol><li>Handles selection-only changes (when from &lt; 0)</li><li>Adjusts change range to block boundaries</li><li>Parses the changed DOM range into a ProseMirror document</li><li>Compares parsed content with current document to find differences</li><li>Applies various browser-specific adjustments</li><li>Creates and dispatches appropriate transactions</li></ol><p><strong>Special Handling:</strong></p><ul><li>Mobile Enter key detection (iOS/Android)</li><li>Type-over selection behavior</li><li>Mark-only changes (bold, italic, etc.)</li><li>Backspace/Enter key event delegation</li><li>Browser-specific quirks (Chrome, Safari, IE11, Android)</li><li>IME composition tracking</li></ul><p><strong>Transaction Types:</strong></p><ul><li>Selection updates (for selection-only changes)</li><li>Content replacements (for insertions/deletions)</li><li>Mark additions/removals (optimized path for styling changes)</li><li>Text insertions (with handleTextInput plugin support)</li></ul><p>The function ensures that all changes maintain document validity and properly handle edge cases across different browsers and input methods.</p><h2 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to “Parameters”">​</a></h2><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>view</code></td><td><code>PmEditorView</code></td><td>The editor view containing the DOM, document state, and plugin system. All changes are relative to view.state.doc at the time of the call.</td></tr><tr><td><code>from</code></td><td><code>number</code></td><td>Start position of the change in the document. Negative values (typically -1) indicate selection-only changes with no content modification.</td></tr><tr><td><code>to</code></td><td><code>number</code></td><td>End position of the change in the document. Forms the range [from, to] that was potentially modified in the DOM.</td></tr><tr><td><code>typeOver</code></td><td><code>boolean</code></td><td>Whether this change is part of typing over an active selection. When true, special handling ensures the entire selection is replaced even if the diff only detects part of the change.</td></tr><tr><td><code>addedNodes</code></td><td>readonly <code>Node</code>[]</td><td>Readonly array of DOM nodes that were added during the mutation. Used for detecting block-level Enter key presses on mobile devices.</td></tr></tbody></table><h2 id="returns" tabindex="-1">Returns <a class="header-anchor" href="#returns" aria-label="Permalink to “Returns”">​</a></h2><p><code>void</code></p><h2 id="see" tabindex="-1">See <a class="header-anchor" href="#see" aria-label="Permalink to “See”">​</a></h2><ul><li><a href="./../../parse-change/parse-between/functions/parseBetween.html">parseBetween</a> for DOM parsing</li><li><a href="./../../parse-change/find-diff/functions/findDiff.html">findDiff</a> for change detection</li><li><a href="./../../parse-change/handle-selection-only-change/functions/handleSelectionOnlyChange.html">handleSelectionOnlyChange</a> for selection updates</li></ul><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to “Example”">​</a></h2><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Called by the DOM observer when mutations are detected</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">view.domObserver.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">flush</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// This internally calls readDOMChange</span></span></code></pre></div>`,23)])])}const k=t(s,[["render",r]]);export{g as __pageData,k as default};
